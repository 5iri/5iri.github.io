<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(3)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(3) > ul > li:nth-child(3) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(3) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(3) > ul > li:nth-child(3) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(3) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(3) > ul.nav-list > li.nav-list-item:nth-child(3) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Why CPUs Use Caches (and What That Even Means) | Shri</title> <meta name="generator" content="Jekyll v3.10.0" /> <meta property="og:title" content="Why CPUs Use Caches (and What That Even Means)" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="guy trying to do something" /> <meta property="og:description" content="guy trying to do something" /> <link rel="canonical" href="http://localhost:4000/markdown_files/posts/content/caches.html" /> <meta property="og:url" content="http://localhost:4000/markdown_files/posts/content/caches.html" /> <meta property="og:site_name" content="Shri" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Why CPUs Use Caches (and What That Even Means)" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"guy trying to do something","headline":"Why CPUs Use Caches (and What That Even Means)","url":"http://localhost:4000/markdown_files/posts/content/caches.html"}</script> <!-- End Jekyll SEO tag --> <link href="https://fonts.googleapis.com/css2?family=Space+Mono&family=Inter&display=swap" rel="stylesheet"> <style> h1, h2, h3, .site-title { font-family: 'Space Mono', monospace !important; } body, p, li { font-family: 'Inter', sans-serif !important; } </style> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" /> <script> window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']] }, options: { skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'] } }; </script> <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script src="https://unpkg.com/darkmode-js/lib/darkmode-js.min.js"></script> <script> new Darkmode({ bottom: '64px', right: '32px', time: '0.5s', mixColor: '#fff', backgroundColor: '#151515', buttonColorDark: '#fff', buttonColorLight: '#000', saveInCookies: true, }).showWidget(); </script> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Shri </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Notes category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/notes" class="nav-list-link">Notes</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Computer Architecture category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/markdown_files/comparch.html" class="nav-list-link">Computer Architecture</a><ul class="nav-list"><li class="nav-list-item"><a href="/notes/comp_arch/agents_for_micro_eval" class="nav-list-link">Agents for Microprocessor Evolution</a></li><li class="nav-list-item"><a href="/notes/comp_arch/DDOS_attacks" class="nav-list-link">Memory Performance Attacts and DOS Attacks</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Math category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/notes/math" class="nav-list-link">Math</a><ul class="nav-list"><li class="nav-list-item"><a href="/notes/math/abstract_algebra" class="nav-list-link">Abstract Algebra</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Other category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/markdown_files/other.html" class="nav-list-link">Other</a><ul class="nav-list"><li class="nav-list-item"><a href="/notes/mapf" class="nav-list-link">Multi-Agent Path Finding Algorithms</a></li><li class="nav-list-item"><a href="/markdown_files/posts/content/basics_of_cancer_cells.html" class="nav-list-link">how cancer cells grow</a></li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Blog category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/blog" class="nav-list-link">Blog</a><ul class="nav-list"><li class="nav-list-item"><a href="/blog/agency" class="nav-list-link">Agency and its meaning</a></li><li class="nav-list-item"><a href="/blog/ApexCore" class="nav-list-link">ApexCore A RISC-V based CPU</a></li><li class="nav-list-item"><a href="/markdown_files/posts/content/caches.html" class="nav-list-link">Why CPUs Use Caches (and What That Even Means)</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Projects category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Projects" class="nav-list-link">Projects</a><ul class="nav-list"><li class="nav-list-item"><a href="/projects/single-riscv-core" class="nav-list-link">Single RISC-V Core</a></li><li class="nav-list-item"><a href="/markdown_files/posts/content/riscv-in-c.html" class="nav-list-link">C-level RISC-V Simulator</a></li><li class="nav-list-item"><a href="/projects/mark2rank" class="nav-list-link">Jee Rank Predictor</a></li><li class="nav-list-item"><a href="/kinematics-demo/" class="nav-list-link">Kinematics Demo</a></li></ul></li><li class="nav-list-item"><a href="/email" class="nav-list-link">Email me!</a></li><li class="nav-list-item"><a href="/github" class="nav-list-link">GitHub</a></li><li class="nav-list-item"><a href="/idea-bank" class="nav-list-link">Idea Bank</a></li><li class="nav-list-item"><a href="/linkedin" class="nav-list-link">LinkedIn</a></li><li class="nav-list-item"><a href="/twitter" class="nav-list-link">X</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Shri" aria-label="Search Shri" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/5iri/5iri.github.io" class="site-button" > View on GitHub </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/blog">Blog</a></li> <li class="breadcrumb-nav-list-item"><span>Why CPUs Use Caches (and What That Even Means)</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="why-cpus-use-caches-and-what-that-even-means"> <a href="#why-cpus-use-caches-and-what-that-even-means" class="anchor-heading" aria-labelledby="why-cpus-use-caches-and-what-that-even-means"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Why CPUs Use Caches (and What That Even Means) </h1> <p>Let’s say you’re working on a project late at night, and you’ve got everything spread across three spots:</p> <ol> <li>The stuff on your desk — super handy.</li> <li>A shelf nearby — still accessible.</li> <li>A dusty cupboard across the room — slow to get to, but it has everything.</li> </ol> <p>Now imagine your CPU is doing the same — just a LOT faster (and without coffee). It has to fetch data to process, and depending on <em>where</em> that data lives, it either grabs it instantly or has to wait a while. That’s basically what <strong>cache memory</strong> is about: <strong>keeping important stuff close so the CPU doesn’t waste time waiting</strong>.</p> <h2 id="the-memory-hierarchy--a-speed-pyramid"> <a href="#the-memory-hierarchy--a-speed-pyramid" class="anchor-heading" aria-labelledby="the-memory-hierarchy--a-speed-pyramid"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The Memory Hierarchy — A Speed Pyramid </h2> <p>CPUs are incredibly fast — like, billions-of-operations-per-second fast. RAM? Not quite as fast. And SSDs? Even slower. So if every time the CPU needed a number, it had to go all the way to RAM or disk, your programs would crawl. To fix this, CPUs use a <strong>memory hierarchy</strong>:</p> <ul> <li><strong>Registers</strong>: Live inside the CPU. Super tiny. Super fast.</li> <li><strong>L1 Cache</strong>: Also on the CPU. Small (like 32–64KB), lightning fast.</li> <li><strong>L2 Cache</strong>: Slightly larger and slower (a few hundred KB to a couple MB).</li> <li><strong>L3 Cache</strong>: Bigger again (MBs), shared between CPU cores.</li> <li><strong>RAM</strong>: Your regular memory. Slower than all of the above.</li> <li><strong>Storage</strong>: HDD/SSD. Huge, but very, very slow in comparison.</li> </ul> <p>Each level is a compromise: faster = smaller &amp; expensive, slower = larger &amp; cheaper.</p> <p>The slowness is also not so obvious to many, but it is literally farer – as in, Caches and Registers are present inside the physical chip of the CPUs that you put inside, whereas the RAM and Storage are seperate chips with different controllers which assemble the stuff that we give it.</p> <h2 id="cache-101-hits-misses-and-why-they-matter"> <a href="#cache-101-hits-misses-and-why-they-matter" class="anchor-heading" aria-labelledby="cache-101-hits-misses-and-why-they-matter"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cache 101: Hits, Misses, and Why They Matter </h2> <p>When the CPU needs a value, it checks the L1 cache first.</p> <ul> <li>If the data is already there: that’s a <strong>cache hit</strong> — fast, good, everyone’s happy.</li> <li>If it’s <em>not</em> there: <strong>cache miss</strong>. Then it tries L2, then L3, and finally RAM.</li> </ul> <p>Every time you “miss” and go down a level, you lose time. RAM might take <strong>100x</strong> longer than L1. That’s like grabbing a pen from your desk vs. walking out to a store to buy one.</p> <p>So smart CPUs try really hard to keep things you <em>probably</em> need in cache — this is where <strong>locality</strong> comes in.</p> <h2 id="locality-cpus-are-predictive-and-lazy"> <a href="#locality-cpus-are-predictive-and-lazy" class="anchor-heading" aria-labelledby="locality-cpus-are-predictive-and-lazy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Locality: CPUs Are Predictive (and Lazy) </h2> <p>Most programs tend to reuse the same data or instructions in loops — this is called <strong>temporal locality</strong>. And when you access one part of an array, chances are you’ll access the nearby parts too — that’s <strong>spatial locality</strong>.</p> <p>So when the CPU fetches a memory location, it grabs a bit extra, just in case. This is why cache lines exist — chunks of memory are brought in, not just individual bytes. And modern CPUs even try to <em>predict</em> what you’ll use next and load it into cache ahead of time.</p> <p>Basically: CPUs are designed to be lazy — they avoid the long walk to RAM as much as possible.</p> <h2 id="l1-l2-l3-the-cache-squad"> <a href="#l1-l2-l3-the-cache-squad" class="anchor-heading" aria-labelledby="l1-l2-l3-the-cache-squad"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> L1, L2, L3: The Cache Squad </h2> <p>Here’s how it generally breaks down:</p> <ul> <li><strong>L1</strong>: Super close to the core. Smallest, fastest. Split into instruction (I-cache) and data (D-cache).</li> <li><strong>L2</strong>: Larger, slightly slower. Usually per core.</li> <li><strong>L3</strong>: Even bigger, slower still. Shared by all cores on the chip.</li> </ul> <p>Let’s say you’re playing a game. The code you’re currently running (rendering, physics) will likely sit in L1. Your last few functions or variables might still be in L2. L3 is like a big backup warehouse — if it’s not in L3, it’ll have to go all the way to RAM (ouch).</p> <h2 id="why-not-just-make-ram-faster"> <a href="#why-not-just-make-ram-faster" class="anchor-heading" aria-labelledby="why-not-just-make-ram-faster"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Why Not Just Make RAM Faster? </h2> <p>Because it’s expensive, complex, and power-hungry. Making all memory as fast as cache would burn a hole in your laptop (and your wallet). Instead, we let RAM be big and slow, and use caches to smooth things over.</p> <p>Smart caching means <strong>you get the speed of small memory, but the flexibility of big memory</strong>.</p> <h2 id="final-thoughts"> <a href="#final-thoughts" class="anchor-heading" aria-labelledby="final-thoughts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Final Thoughts </h2> <p>So yeah, CPUs are fast — but memory can be a bottleneck. Caches are the clever workaround: they’re like tiny, super-speedy notebooks sitting next to your brain. Use them well, and everything flies.</p> <p>Next time your program is “slow,” maybe it’s not your code — maybe it just missed the drawer.</p> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
